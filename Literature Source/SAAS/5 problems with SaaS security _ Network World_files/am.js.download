(function() {var domains=['spanish.sling.com','www.evoice.com','www.mountainhardwear.com','www.getresponse.com','www.interserver.net','usa.kaspersky.com','www.gamesdeal.com','us-store.acer.com','us.nd-bd.com','cn.gamesdeal.com','store.wdc.com','www.irobot.com','www.scosche.com','cyberlink.com','cameta.com','kinguin.net','www.factoryoutletstore.com','mediatemple.net','www.roxio.de','www.appliancesconnection.com','autodesk.com','silagames.com','www.123inkcartridges.ca','www.digitalrev.com','www.republicwireless.com','www.clickmeeting.com','kingsbottle.com','eglobalcentral.com','www.focuscamera.com','www.vipreantivirus.com','bluehost.com','www.nuance.com','www.fatbraintoys.com','www.jabra.com','www.restaurant.com','fr.gamesdeal.com','www.wondershare.fr','logitech.com','qlinkwireless.com','www.wondershare.it','getresponse.ru','buy.garmin.com','urbanears.com','getresponse.pl','www.wondershare.de','www.wondershare.es','getresponse.es','netfirms.com','htc.com','www.avg.com','quill.com','microsofthup.com','www.cvs.com','shop.crayola.com','startrek.com','www.eibmarkt.com','www.jbl.com','www.otterbox.com','autodesk.fr','autodesk.es','autodesk.eu','www.phonegala.com','www.conrad.com','www.clickandgrow.com','www.sonos.com','verizonwireless.com','shop.usa.canon.com','www.macmall.com','logoworks.com','idrive.com','getreponse.co.uk','www.powweb.com','www.abacus24-7.com','olloclip.com','support.code42.com','autodesk.it','www.ihomeaudio.com','www.officedepot.com','razerzone.com','www.entertainmentearth.com','magix.com','gpsorigins.com','justhost.com','www.dell.com','www.searchmetrics.com','www.harmanaudio.com','www.acronis.com','www.justhost.com','specials.restaurant.com','www.autodesk.de','www.monoprice.com','tickets.fandango.com','gamefly.com','www.beachcamera.com','www.lightingbox.com','www.hostgator.com','shop.straighttalk.com','www.hobbytron.com','magix.com','buy.guildwars2.com','www.gamersgate.com','cvs.com','zagg.com','www.upstart.com','pl.gamesdeal.com','www.cellularoutfitter.com','www.eset.com','rosettastone.de','www.nchsoftware.com','eglobalcentral.de','www.corsair.com','eglobalcentral.at','www.verizonwireless.com','eglobalcentral.be','tigerdirect.com','kaspersky.co.uk','eshop.macsales.com','www.autodesk.co.uk','eglobalcentral.eu','eglobalcentral.fr','www.lunarpages.com','www.hosting.co.uk','www.netfirms.com','www.zagg.com','www.pcm.com','www.oo-software.com','www.dudamobile.com','www.harmankardon.com','uk.nd-bd.com','turbotax.intuit.com','www.contentwatch.com','otterbox.com','fr.farnell.com','www.parrot.com','ipage.com','f-secure.com','www.fandangofanshop.com','www.123inkjets.com','www.monsterproducts.com','crayola.com','www.compandsave.com','www.m.cvs.com','www.1-800-inkfarm.com','store.omronhealthcare.com','www.logogarden.com','magix-audio.com','irobot.fr','us.store.parrot.com','www.samsung.com','blinkforhome.com','powweb.com','www.irobot.co.uk','irobot.de','irobot.es','ie.nd-bd.com','wdc.com','fr.caseable.com','www.irobot.es','outdoortechnology.com','www.irobot.fr','www.icontact.com','eu.caseable.com','www.irobot.de','roxio.com','www.legalzoom.com','knownhost.com','shop.tracfone.com','www.straighttalk.com','www.encore.com','www.bose.fr','www.emclient.com','www.tomtom.com','mobile.fandango.com','www.shopcasio.com','www.hammacher.com','suite.searchmetrics.com','www.accessorygeeks.com','www.brickhousesecurity.com','dev.getresponse.com','buy.norton.com','www.epson.com','www.all-battery.com','samsung.com','hu.gamesdeal.com','www.tmart.com','epson.com','www.motorola.com','www.stopzilla.com','flash.newegg.com','www.hostpapa.eu','irobot.co.uk','www.hostpapa.ca','uk.crucial.com','shopqlink.com','www.buydig.com','hostpapa.no.nz','www.sprint.com','www.jomashop.com','techrabbit.com','scdkey.com','store.silagames.com','omronhealthcare.com','www.lynda.com','humancharger.com','www.efax.com','www.net10wireless.com','www.inkjetsuperstore.com','www.intego.com','www.taxact.com','www.staples.com','www.123ink.ca','www.knownhost.com','upstart.com','lynda.com','www.macsales.com','www.techforless.com','m.cellularoutfitter.com','www.viva-media.com','razerzone.com','republicwireless.com','www.punchsoftware.com','eibmarkt.com','crucial.com','mackeeper.kromtech.net','www.omnis.com','kaspersky.fr','vive.com','www.primecables.ca','www.uscellular.com','benqdirect.com','www.webhallen.com','griffintechnology.com','homedna.com','www.bose.com','au.nd-bd.com','www.roku.com','kasperskystore.it','www.domain.com','promo.shopperplus.com','www.bluehost.com','www.rosettastone.co.uk','www.neat.com','www.marshallheadphones.com','shop.sprint.com','www.mmoga.co.uk','freedompop.com','www.antennasdirect.com','gameladen','macmall.com','www.newegg.ca','www.case-mate.com','www.dell.com','www.socialengine.com','www.einvite.com','shop.net10wireless.com','academicsuperstore.com','www.wondershare.com','www.flash.newegg.com','dell','dynadot.com','marshallheadphones.com','www.mwave.com','blinq.com','www.roxio.com','eglobalcentral.co.it','www.connectyourhome.com','www.crayola.com','www.superbiiz.com','www.tigerdirect.com','www.getolympus.com','smallbusiness.yahoo.com','eglobalcentral.co.uk','secure.getresponse.com','www.tracfone.com','dell.com','www.oreilly.com','www.focalprice.com','www.suppliesoutlet.com','dyn.com','es.gamesdeal.com','www.smithsonianstore.com','www.staples.co.uk','www.cellularoutfitter.ca','www.identcheck.net','www.greenmangaming.com','m.legalzoom.com','www.parallels.com','www.newegg.com','www.3dcart.com','www.heartinternet.co.uk','www.code42.com','www.macwashingmachine.com','www.360training.com','www.fitbit.com','www.autodesk.com','www.neweggbusiness.com','connect.getresponse.com','it.gamesdeal.com','www.punchcad.com','corsair.com','www.comboink.com','case-mate.com','www.inkcartridges.com','www.kaspersky.co.uk','rosettastone.co.uk','smarthome.com','shop.startrek.com','www.iolo.com','avast.com','www.cameta.com','www.vegascreativesoftware.com','www.omnisnetwork.biz','www.broderbund.com','contabo.com','de.gamesdeal.com','www.shopperplus.com','avg.com','www.ipage.com','www.urbanears.com','www.hostpapa.com','bulbhead.com','uscellular.com','searchmetrics.com','m.cvs.com','gamersgate.com','appliancesconnection.com','www.hostpapa.sg','www.mmoga.com','www.one.com','autodesk.co.uk','www.photogear.com','www.dfsdirectsales.com','store.irobot.com','www.4inkjets.com','www.hoylegaming.com','eglobalcentral.com.es','www.fandango.com','www.inmotionhosting.com','www.sling.com','www.fandangonow.com','www.gamefly.com','www.caseable.com'];var websiteId=8200811;var trackingServerDomain='www.anrdoezrs.net';var generateLinkOnLoad=true;var publisherId=4832273;var sid='nww';var debug=false;(function() {
    var getPageBasedImpressionUrl = function() {
        return '//' + trackingServerDomain + '/pageImpression';
    },
    collectDomains = function (content) {
        var collectedDomains =  [];
        var anchors = content.getElementsByTagName("a");
        for (var i = 0; i < anchors.length; i++) {
            var url = anchors[i].href;
            collectedDomains.push(url.toLowerCase());
        }
        return collectedDomains;
    },
    collectImpressions = function(doc) {
        var imgs = doc.getElementsByTagName("img");
        var srcs = [];
        for (var i=0; i < imgs.length; i++) {
            var matches = imgs[i].src.match(/image-(\d+-\d+)/);
            if (matches) {
                srcs.push(imgs[i].src);
            }
        }
        return srcs;
    },
    appendThirdPartyImpressions = function(thirdPartyImpressions) {
        var impressionSources = JSON.parse(thirdPartyImpressions);
        for(var i=0; i<impressionSources.length; i++) {
            var hiddenDiv = document.createElement("div");
            var url = impressionSources[i] + '&cachebuster=' + i;
            hiddenDiv.innerHTML = "<img style=\"display:none\" src=\"" + url + "\" />";
            document.body.appendChild(hiddenDiv.firstChild);
        }
    },
    trackImpressions = function (doc) {
        var xhr = createCORSRequest('POST', getPageBasedImpressionUrl());
        if (xhr) {
            xhr.send(JSON.stringify({
                publisherId: publisherId,
                websiteId: websiteId,
                urls: collectDomains(doc),
                impressions: collectImpressions(doc)
            }));

            xhr.onreadystatechange = function() {
                if(xhr.readyState === 4 && xhr.status == 200) {
                    var thirdPartyImpressions = xhr.responseText;
                    if(thirdPartyImpressions !== undefined && thirdPartyImpressions.length > 0) {
                        appendThirdPartyImpressions(thirdPartyImpressions);
                    }
                }
            };
        }
    },
    createCORSRequest = function(method, url) {
        var xhr = new XMLHttpRequest();

        if ("withCredentials" in xhr) {
            xhr.open(method, url, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.withCredentials = true;
        } else if (typeof XDomainRequest != "undefined") {
            // IE <9 way of making CORS requests
            xhr = new XDomainRequest();
            xhr.open(method, url);
        } else {
            xhr = null;
        }
        return xhr;
    };

    return trackImpressions(document);
})();
(function() {
    function log(consoleStr){
        if (debug && window.console){
            console.log(consoleStr);
        }
    }

//IE 8 doesn't have indexOf
    if(!Array.prototype.indexOf) {
        log("shimming Array.indexOf ...");
        Array.prototype.indexOf = function (obj, start) {
            for (var i = (start || 0), j = this.length; i < j; i++) {
                if (this[i] === obj) {
                    return i;
                }
            }
            return -1;
        }
    }

//dom ready with support for older browsers (IE8)
//  if support no longer needed, just use
//      document.addEventListener("DOMContentLoaded", handler, false)
    function bindReady(handler) {

        var called = false;

        function ready() {
            if (called) return;
            called = true;
            handler()
        }

        if (document.addEventListener) { // native event
            log("using native addEventListener");
            document.addEventListener("DOMContentLoaded", ready, false)
        } else if (document.attachEvent) {  // IE

            try {
                var isFrame = window.frameElement != null
            } catch (e) {
            }

            // IE, the document is not inside a frame
            if (document.documentElement.doScroll && !isFrame) {
                function tryScroll() {
                    if (called) return;
                    try {
                        document.documentElement.doScroll("left");
                        log("using doScroll hack");
                        ready()
                    } catch (e) {
                        setTimeout(tryScroll, 10)
                    }
                }

                tryScroll()
            }

            // IE, the document is inside a frame
            document.attachEvent("onreadystatechange", function () {
                if (document.readyState === "complete") {
                    log("using onreadystatechange");
                    ready()
                }
            })
        }

        // Old browsers
        if (window.addEventListener) {
            log("using window addEventListener");
            window.addEventListener('load', ready, false)
        }
        else if (window.attachEvent) {
            log("using attachEvent onload");
            window.attachEvent('onload', ready)
        }
        else {
            var fn = window.onload; // very old browser, copy old onload
            window.onload = function () { // replace by new onload and call the old one
                log("using window.onload");
                fn && fn();
                ready()
            }
        }
    }

//IE 8 doesn't have addEventListener
    function addEvent(element, event, func) {
        if(element.addEventListener) {
            element.addEventListener(event, func);
        }
        else if(element.attachEvent) { // IE DOM
            element.attachEvent("on" + event, func);
        }
    }

    function getDomainAndProtocol(url) {
        var matches = url.match(/^(https?)\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);
        var protocol = matches && matches[1];
        var domain = matches && matches[2];
        return {domain: domain, protocol: protocol };
    }

    function matchesParentDomain(domain) {
        for (var i=0; i < domains.length; i++){
            var suffix = domains[i];
            if (domain.indexOf(suffix, domain.length - suffix.length) !== -1)
                return true;
        }
        return false
    }

    function autoMonetizeLink(element){
        var start = new Date().getTime();
        var url = element.href;
        var domainAndProtocol = getDomainAndProtocol(url);
        if(!domainAndProtocol.domain) return;

        var domainInLowerCase = domainAndProtocol.domain.toLowerCase();
        var hashIndex = url.indexOf('#');
        var frag = "";
        if (hashIndex > -1) {
            frag = url.substring(hashIndex + 1);
            url = url.substring(0, hashIndex);
        }
        if (domains.indexOf(domainInLowerCase) >= 0 || matchesParentDomain(domainInLowerCase)) {
            log("Domain found in list. Automonetizing...");
            var extraParams = "";
            if (sid) {
                extraParams = "/sid/" + sid;
            }
            if(frag) {
                extraParams = extraParams + "/fragment/" + encodeURIComponent(frag);
            }
            element.href = "//" + trackingServerDomain + "/links/" + websiteId + "/type/am" + extraParams + "/" + url;
        } else {
            log("Domain not found in list. ");
        }

        log("total time: " + (new Date().getTime() - start));
    }

    function createClickHandlerFor(element) {
        return function () {
            autoMonetizeLink(element)
        };
    }

    function autoMonetizeLinks() {
        log("auto monetizing links");

        var anchors = document.getElementsByTagName("a");
        log("found " + anchors.length + " a tags.");
        for (var i = 0; i < anchors.length; i++) {
            var anchor = anchors[i];
            if(generateLinkOnLoad)
                autoMonetizeLink(anchor);
            else
                addEvent(anchor, "click", createClickHandlerFor(anchor));
        }
    }

    if(document.readyState === "complete") {
        log("readState is complete");
        autoMonetizeLinks();
    } else {
        log("DOMContentLoaded is registered");
        bindReady(autoMonetizeLinks)
    }
})();
})()